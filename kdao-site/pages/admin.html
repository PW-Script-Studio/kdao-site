<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KDAO Admin Panel</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: #0a0f1b;
            color: #ffffff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
        }

        /* Language Switcher */
        .admin-lang-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            display: flex;
            gap: 10px;
            background: rgba(10, 15, 27, 0.9);
            padding: 5px;
            border-radius: 8px;
            border: 1px solid rgba(95, 251, 241, 0.2);
        }

        .lang-btn {
            padding: 8px 16px;
            background: transparent;
            color: #94a3b8;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        .lang-btn:hover {
            background: rgba(95, 251, 241, 0.1);
            color: #ffffff;
        }

        .lang-btn.active {
            background: linear-gradient(135deg, #5ffbf1 0%, #26d0a8 100%);
            color: #030712;
            font-weight: 600;
        }

        /* Admin Header */
        .admin-header {
            background: linear-gradient(135deg, rgba(14, 28, 54, 0.9) 0%, rgba(10, 20, 40, 0.95) 100%);
            border-bottom: 1px solid rgba(95, 251, 241, 0.3);
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-title {
            font-size: 24px;
            font-weight: 800;
            color: #5ffbf1;
        }

        .header-right {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 15px;
            background: rgba(95, 251, 241, 0.1);
            border: 1px solid rgba(95, 251, 241, 0.2);
            border-radius: 8px;
        }

        .user-role {
            padding: 4px 10px;
            background: linear-gradient(135deg, #9333ea, #c084fc);
            color: #ffffff;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }

        .user-role.editor {
            background: linear-gradient(135deg, #3b82f6, #60a5fa);
        }

        .user-role.viewer {
            background: linear-gradient(135deg, #6b7280, #9ca3af);
        }

        .logout-btn {
            padding: 8px 20px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .logout-btn:hover {
            background: rgba(239, 68, 68, 0.3);
        }

        /* Login Form */
        .login-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
        }

        .login-form {
            background: linear-gradient(135deg, rgba(14, 28, 54, 0.6) 0%, rgba(10, 20, 40, 0.8) 100%);
            border: 1px solid rgba(95, 251, 241, 0.2);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
        }

        .login-form h2 {
            text-align: center;
            color: #5ffbf1;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #94a3b8;
            font-size: 14px;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(95, 251, 241, 0.2);
            border-radius: 8px;
            color: #ffffff;
            font-size: 14px;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #5ffbf1;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #5ffbf1 0%, #26d0a8 100%);
            color: #030712;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(95, 251, 241, 0.3);
        }

        /* Admin Dashboard */
        .admin-container {
            display: none;
            padding: 20px;
        }

        .admin-container.active {
            display: block;
        }

        /* Tabs */
        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 1px solid rgba(95, 251, 241, 0.1);
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            background: transparent;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 2px solid transparent;
        }

        .tab-btn:hover {
            color: #ffffff;
        }

        .tab-btn.active {
            color: #5ffbf1;
            border-bottom-color: #5ffbf1;
        }

        .tab-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Form Sections */
        .admin-section {
            background: linear-gradient(135deg, rgba(14, 28, 54, 0.4) 0%, rgba(10, 20, 40, 0.6) 100%);
            border: 1px solid rgba(95, 251, 241, 0.15);
            border-radius: 16px;
            padding: 30px;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            color: #5ffbf1;
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        textarea {
            width: 100%;
            padding: 12px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(95, 251, 241, 0.2);
            border-radius: 8px;
            color: #ffffff;
            font-family: inherit;
            resize: vertical;
            min-height: 100px;
        }

        .save-btn {
            padding: 12px 30px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: #ffffff;
            border: none;
            border-radius: 8px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
        }

        .save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(16, 185, 129, 0.3);
        }

        /* Item Cards */
        .item-card {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(95, 251, 241, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .item-card.active {
            border-color: rgba(16, 185, 129, 0.3);
            background: rgba(16, 185, 129, 0.05);
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 15px;
        }

        .item-title {
            font-size: 16px;
            font-weight: 600;
            color: #ffffff;
        }

        .item-actions {
            display: flex;
            gap: 10px;
        }

        .edit-btn {
            padding: 6px 12px;
            background: rgba(95, 251, 241, 0.1);
            border: 1px solid rgba(95, 251, 241, 0.2);
            color: #5ffbf1;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .delete-btn {
            padding: 6px 12px;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #ef4444;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .status-toggle {
            padding: 6px 12px;
            background: rgba(251, 191, 36, 0.2);
            border: 1px solid rgba(251, 191, 36, 0.3);
            color: #fbbf24;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
        }

        .status-toggle.active {
            background: rgba(16, 185, 129, 0.2);
            border-color: rgba(16, 185, 129, 0.3);
            color: #10b981;
        }

        .add-btn {
            padding: 10px 20px;
            background: rgba(95, 251, 241, 0.1);
            border: 1px solid rgba(95, 251, 241, 0.2);
            color: #5ffbf1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .add-btn:hover {
            background: rgba(95, 251, 241, 0.2);
        }

        /* Users Table */
        .users-table {
            width: 100%;
            border-collapse: collapse;
        }

        .users-table th {
            text-align: left;
            padding: 12px;
            background: rgba(95, 251, 241, 0.05);
            border-bottom: 1px solid rgba(95, 251, 241, 0.2);
            color: #5ffbf1;
            font-size: 13px;
            text-transform: uppercase;
        }

        .users-table td {
            padding: 12px;
            border-bottom: 1px solid rgba(95, 251, 241, 0.05);
            font-size: 14px;
        }

        .users-table tr:hover {
            background: rgba(95, 251, 241, 0.02);
        }

        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: rgba(16, 185, 129, 0.2);
            border: 1px solid rgba(16, 185, 129, 0.3);
            color: #10b981;
            border-radius: 8px;
            display: none;
            animation: slideIn 0.3s ease;
            z-index: 1000;
        }

        @keyframes slideIn {
            from {
                transform: translateX(100%);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .edit-mode {
            display: none;
        }

        .edit-mode.active {
            display: block;
        }

        .view-mode.hidden {
            display: none;
        }

        .phase-complete {
            text-decoration: line-through;
            opacity: 0.5;
        }

        /* Permission message */
        .no-permission {
            padding: 40px;
            text-align: center;
            color: #ef4444;
            background: rgba(239, 68, 68, 0.1);
            border: 1px solid rgba(239, 68, 68, 0.2);
            border-radius: 12px;
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="admin-lang-switcher">
        <button class="lang-btn active" onclick="setAdminLanguage('de')">üá©üá™ DE</button>
        <button class="lang-btn" onclick="setAdminLanguage('en')">üá¨üáß EN</button>
    </div>

    <!-- Success Message -->
    <div class="success-message" id="successMessage">
        <span data-lang="de">√Ñnderungen erfolgreich gespeichert!</span>
        <span data-lang="en" style="display:none;">Changes saved successfully!</span>
    </div>

    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-form">
            <h2>üîê KDAO Admin Panel</h2>
            <form onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label>
                        <span data-lang="de">Benutzername</span>
                        <span data-lang="en" style="display:none;">Username</span>
                    </label>
                    <input type="text" id="username" required>
                </div>
                <div class="form-group">
                    <label>
                        <span data-lang="de">Passwort</span>
                        <span data-lang="en" style="display:none;">Password</span>
                    </label>
                    <input type="password" id="password" required>
                </div>
                <button type="submit" class="login-btn">
                    <span data-lang="de">Einloggen</span>
                    <span data-lang="en" style="display:none;">Login</span>
                </button>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div class="admin-container" id="adminContainer">
        <!-- Header -->
        <div class="admin-header">
            <h1 class="admin-title">KDAO Admin Panel</h1>
            <div class="header-right">
                <div class="user-info">
                    <span id="currentUsername">admin</span>
                    <span class="user-role" id="currentUserRole">Admin</span>
                </div>
                <button class="logout-btn" onclick="handleLogout()">
                    <span data-lang="de">Ausloggen</span>
                    <span data-lang="en" style="display:none;">Logout</span>
                </button>
            </div>
        </div>

        <!-- Tabs -->
        <div class="admin-tabs">
            <button class="tab-btn active" onclick="switchTab('dashboard')">Dashboard</button>
            <button class="tab-btn" onclick="switchTab('news')">News</button>
            <button class="tab-btn" onclick="switchTab('team')">Team</button>
            <button class="tab-btn" onclick="switchTab('roadmap')">Roadmap</button>
            <button class="tab-btn" onclick="switchTab('users')" id="usersTab">
                <span data-lang="de">Benutzer</span>
                <span data-lang="en" style="display:none;">Users</span>
            </button>
            <button class="tab-btn" onclick="switchTab('settings')">
                <span data-lang="de">Einstellungen</span>
                <span data-lang="en" style="display:none;">Settings</span>
            </button>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard-tab">
            <div class="admin-section">
                <h2 class="section-title">
                    <span data-lang="de">üìä √úbersicht</span>
                    <span data-lang="en" style="display:none;">üìä Overview</span>
                </h2>
                <div class="form-row">
                    <div class="item-card">
                        <h3>
                            <span data-lang="de">News Artikel</span>
                            <span data-lang="en" style="display:none;">News Articles</span>
                        </h3>
                        <p id="newsCount">0 <span data-lang="de">Artikel</span><span data-lang="en" style="display:none;">Articles</span></p>
                    </div>
                    <div class="item-card">
                        <h3>
                            <span data-lang="de">Team Mitglieder</span>
                            <span data-lang="en" style="display:none;">Team Members</span>
                        </h3>
                        <p id="teamCount">0 <span data-lang="de">Aktiv</span><span data-lang="en" style="display:none;">Active</span> / 0 <span data-lang="de">Gesamt</span><span data-lang="en" style="display:none;">Total</span></p>
                    </div>
                    <div class="item-card">
                        <h3>
                            <span data-lang="de">Roadmap Phasen</span>
                            <span data-lang="en" style="display:none;">Roadmap Phases</span>
                        </h3>
                        <p id="roadmapCount">0 <span data-lang="de">Erledigt</span><span data-lang="en" style="display:none;">Complete</span> / 0 <span data-lang="de">Gesamt</span><span data-lang="en" style="display:none;">Total</span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- News Tab -->
        <div class="tab-content" id="news-tab">
            <div class="admin-section" id="newsSection">
                <!-- Content will be loaded based on permissions -->
            </div>
        </div>

        <!-- Team Tab -->
        <div class="tab-content" id="team-tab">
            <div class="admin-section" id="teamSection">
                <!-- Content will be loaded based on permissions -->
            </div>
        </div>

        <!-- Roadmap Tab -->
        <div class="tab-content" id="roadmap-tab">
            <div class="admin-section" id="roadmapSection">
                <!-- Content will be loaded based on permissions -->
            </div>
        </div>

        <!-- Users Tab (Admin only) -->
        <div class="tab-content" id="users-tab">
            <div class="admin-section">
                <h2 class="section-title">
                    <span data-lang="de">Benutzerverwaltung</span>
                    <span data-lang="en" style="display:none;">User Management</span>
                </h2>
                
                <!-- Add User Form -->
                <div class="item-card">
                    <h3>
                        <span data-lang="de">Neuen Benutzer hinzuf√ºgen</span>
                        <span data-lang="en" style="display:none;">Add New User</span>
                    </h3>
                    <form onsubmit="addUser(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>
                                    <span data-lang="de">Benutzername</span>
                                    <span data-lang="en" style="display:none;">Username</span>
                                </label>
                                <input type="text" id="new-username" required>
                            </div>
                            <div class="form-group">
                                <label>
                                    <span data-lang="de">Passwort</span>
                                    <span data-lang="en" style="display:none;">Password</span>
                                </label>
                                <input type="password" id="new-password" required>
                            </div>
                            <div class="form-group">
                                <label>
                                    <span data-lang="de">Rolle</span>
                                    <span data-lang="en" style="display:none;">Role</span>
                                </label>
                                <select id="new-role" required>
                                    <option value="admin">Admin</option>
                                    <option value="editor">Editor</option>
                                    <option value="viewer">Viewer</option>
                                </select>
                            </div>
                        </div>
                        <button type="submit" class="save-btn">
                            <span data-lang="de">Benutzer hinzuf√ºgen</span>
                            <span data-lang="en" style="display:none;">Add User</span>
                        </button>
                    </form>
                </div>

                <!-- Users List -->
                <h3 style="margin: 30px 0 20px;">
                    <span data-lang="de">Bestehende Benutzer</span>
                    <span data-lang="en" style="display:none;">Existing Users</span>
                </h3>
                <table class="users-table">
                    <thead>
                        <tr>
                            <th>
                                <span data-lang="de">Benutzername</span>
                                <span data-lang="en" style="display:none;">Username</span>
                            </th>
                            <th>
                                <span data-lang="de">Rolle</span>
                                <span data-lang="en" style="display:none;">Role</span>
                            </th>
                            <th>
                                <span data-lang="de">Berechtigungen</span>
                                <span data-lang="en" style="display:none;">Permissions</span>
                            </th>
                            <th>
                                <span data-lang="de">Aktionen</span>
                                <span data-lang="en" style="display:none;">Actions</span>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="usersList"></tbody>
                </table>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings-tab">
            <div class="admin-section">
                <h2 class="section-title">
                    <span data-lang="de">Allgemeine Einstellungen</span>
                    <span data-lang="en" style="display:none;">General Settings</span>
                </h2>
                <form onsubmit="saveSettings(event)">
                    <div class="form-group">
                        <label>Discord Link</label>
                        <input type="url" id="discord-link" value="https://discord.gg/kaspadao">
                    </div>
                    <div class="form-group">
                        <label>Twitter Link</label>
                        <input type="url" id="twitter-link" value="https://twitter.com/kaspadao">
                    </div>
                    <div class="form-group">
                        <label>CoinEx Trading Link</label>
                        <input type="url" id="coinex-link" value="https://www.coinex.com/exchange/kdao-usdt">
                    </div>
                    <button type="submit" class="save-btn">
                        <span data-lang="de">Einstellungen speichern</span>
                        <span data-lang="en" style="display:none;">Save Settings</span>
                    </button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // User roles and permissions
        const ROLES = {
            admin: {
                name: 'Admin',
                permissions: ['all']
            },
            editor: {
                name: 'Editor',
                permissions: ['news', 'team', 'roadmap', 'settings']
            },
            viewer: {
                name: 'Viewer',
                permissions: ['view']
            }
        };

        // Default users
        const defaultUsers = [
            { username: 'admin', password: 'kdao2025', role: 'admin' },
            { username: 'editor', password: 'editor123', role: 'editor' },
            { username: 'viewer', password: 'view123', role: 'viewer' }
        ];

        // Current user
        let currentUser = null;
        let currentLang = 'de';

        // Default team positions
        const defaultTeamPositions = [
            { id: 1, category: 'F√ºhrungsebene', position: 'Projektleiter / Koordinator', name: '', status: 'vacant', description: 'Gesamtverantwortung f√ºr KDAO 2.0' },
            { id: 2, category: 'Technisches Team', position: 'Tech Lead', name: '', status: 'vacant', description: 'Smart Contracts & Blockchain' },
            { id: 3, category: 'Technisches Team', position: 'Backend Developer', name: '', status: 'vacant', description: 'Infrastructure & APIs' },
            { id: 4, category: 'Technisches Team', position: 'Frontend Developer', name: 'Peter Wittner', status: 'active', description: 'UI/UX Design und Development' },
            { id: 5, category: 'Operations', position: 'Treasury Manager', name: '', status: 'vacant', description: 'DAO Schatzmeister' },
            { id: 6, category: 'Operations', position: 'Governance Manager', name: '', status: 'vacant', description: 'DAO Governance' },
            { id: 7, category: 'Operations', position: 'Legal Advisor', name: '', status: 'vacant', description: 'Rechts- & Compliance' },
            { id: 8, category: 'Community', position: 'Community Lead', name: '', status: 'vacant', description: 'Communications & Social' },
            { id: 9, category: 'Community', position: 'Partnership Manager', name: '', status: 'vacant', description: 'Ecosystem Development' }
        ];

        // Default roadmap phases
        const defaultRoadmapPhases = [
            { id: 1, title: 'Phase 1 ‚Äì Governance & Struktur', date: 'September 2025', completed: false, description: 'Neuwahlen & Team-Aufstellung' },
            { id: 2, title: 'Phase 2 ‚Äì Fundament & Transparenz', date: 'September 2025', completed: false, description: 'Ver√∂ffentlichung der finalen KDAO 2.0 Vision' },
            { id: 3, title: 'Phase 3 ‚Äì Liquidity & DeFi', date: 'Okt - Nov 2025', completed: false, description: 'Start des Liquidity Pools auf Kaspa.com' },
            { id: 4, title: 'Phase 4 ‚Äì Ecosystem & Launchpad', date: 'Dez 2025 - Jan 2026', completed: false, description: 'KDAO als Community-Launchpad' },
            { id: 5, title: 'Phase 5 ‚Äì Wachstum & Zukunft', date: '2026+', completed: false, description: 'Community & Marketing-Expansion' }
        ];

        // Language Management
        function setAdminLanguage(lang) {
            currentLang = lang;
            localStorage.setItem('adminLang', lang);
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.textContent.includes(lang.toUpperCase())) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('[data-lang]').forEach(element => {
                element.style.display = 'none';
            });
            document.querySelectorAll(`[data-lang="${lang}"]`).forEach(element => {
                element.style.display = element.tagName === 'SPAN' ? 'inline' : 'block';
            });
        }

        // Check permissions
        function hasPermission(action) {
            if (!currentUser) return false;
            const role = ROLES[currentUser.role];
            return role.permissions.includes('all') || role.permissions.includes(action);
        }

        // Check if logged in
        function checkAuth() {
            const authData = localStorage.getItem('kdaoAdminAuth');
            if (authData) {
                currentUser = JSON.parse(authData);
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').classList.add('active');
                document.getElementById('currentUsername').textContent = currentUser.username;
                document.getElementById('currentUserRole').textContent = ROLES[currentUser.role].name;
                document.getElementById('currentUserRole').className = `user-role ${currentUser.role}`;
                
                // Show/hide tabs based on permissions
                if (currentUser.role !== 'admin') {
                    document.getElementById('usersTab').style.display = 'none';
                }
                
                loadAllData();
            }
        }

        // Handle login
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            const users = JSON.parse(localStorage.getItem('kdaoUsers') || JSON.stringify(defaultUsers));
            const user = users.find(u => u.username === username && u.password === password);
            
            if (user) {
                currentUser = user;
                localStorage.setItem('kdaoAdminAuth', JSON.stringify(user));
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('adminContainer').classList.add('active');
                document.getElementById('currentUsername').textContent = user.username;
                document.getElementById('currentUserRole').textContent = ROLES[user.role].name;
                document.getElementById('currentUserRole').className = `user-role ${user.role}`;
                
                if (user.role !== 'admin') {
                    document.getElementById('usersTab').style.display = 'none';
                }
                
                loadAllData();
            } else {
                alert(currentLang === 'de' ? 'Ung√ºltige Anmeldedaten!' : 'Invalid credentials!');
            }
        }

        // Handle logout
        function handleLogout() {
            localStorage.removeItem('kdaoAdminAuth');
            currentUser = null;
            location.reload();
        }

        // Switch tabs
        function switchTab(tabName) {
            if (!hasPermission(tabName) && tabName !== 'dashboard') {
                alert(currentLang === 'de' ? 'Keine Berechtigung!' : 'No permission!');
                return;
            }
            
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('active');
                if(btn.textContent.toLowerCase().includes(tabName.toLowerCase()) || 
                   (tabName === 'dashboard' && btn.textContent === 'Dashboard')) {
                    btn.classList.add('active');
                }
            });
            
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabName}-tab`).classList.add('active');
        }

        // Load all data
        function loadAllData() {
            loadNews();
            loadTeam();
            loadRoadmap();
            loadUsers();
            updateDashboard();
        }

        // Update Dashboard
        function updateDashboard() {
            const news = JSON.parse(localStorage.getItem('kdaoNews') || '[]');
            const team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            const roadmap = JSON.parse(localStorage.getItem('kdaoRoadmap') || JSON.stringify(defaultRoadmapPhases));
            
            const newsText = currentLang === 'de' ? 'Artikel' : 'Articles';
            document.getElementById('newsCount').innerHTML = `${news.length} ${newsText}`;
            
            const activeTeam = team.filter(m => m.status === 'active').length;
            const activeText = currentLang === 'de' ? 'Aktiv' : 'Active';
            const totalText = currentLang === 'de' ? 'Gesamt' : 'Total';
            document.getElementById('teamCount').innerHTML = `${activeTeam} ${activeText} / ${team.length} ${totalText}`;
            
            const completedPhases = roadmap.filter(p => p.completed).length;
            const completeText = currentLang === 'de' ? 'Erledigt' : 'Complete';
            document.getElementById('roadmapCount').innerHTML = `${completedPhases} ${completeText} / ${roadmap.length} ${totalText}`;
        }

        // NEWS MANAGEMENT
        function loadNews() {
            const container = document.getElementById('newsSection');
            
            if (!hasPermission('news')) {
                container.innerHTML = `<div class="no-permission">${currentLang === 'de' ? 'Keine Berechtigung f√ºr diesen Bereich' : 'No permission for this section'}</div>`;
                return;
            }
            
            const news = JSON.parse(localStorage.getItem('kdaoNews') || '[]');
            
            container.innerHTML = `
                <h2 class="section-title">${currentLang === 'de' ? 'News Verwaltung' : 'News Management'}</h2>
                
                <div class="item-card">
                    <h3>${currentLang === 'de' ? 'Neuen Artikel hinzuf√ºgen' : 'Add New Article'}</h3>
                    <form onsubmit="addNews(event)">
                        <div class="form-row">
                            <div class="form-group">
                                <label>${currentLang === 'de' ? 'Titel (DE)' : 'Title (DE)'}</label>
                                <input type="text" id="news-title-de" required>
                            </div>
                            <div class="form-group">
                                <label>${currentLang === 'de' ? 'Titel (EN)' : 'Title (EN)'}</label>
                                <input type="text" id="news-title-en" required>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>${currentLang === 'de' ? 'Inhalt (DE)' : 'Content (DE)'}</label>
                            <textarea id="news-content-de" rows="4" required></textarea>
                        </div>
                        <div class="form-group">
                            <label>${currentLang === 'de' ? 'Inhalt (EN)' : 'Content (EN)'}</label>
                            <textarea id="news-content-en" rows="4" required></textarea>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>${currentLang === 'de' ? 'Datum' : 'Date'}</label>
                                <input type="date" id="news-date" required>
                            </div>
                            <div class="form-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="news-featured">
                                    ${currentLang === 'de' ? 'Als Featured markieren' : 'Mark as Featured'}
                                </label>
                            </div>
                        </div>
                        <button type="submit" class="save-btn">${currentLang === 'de' ? 'Artikel hinzuf√ºgen' : 'Add Article'}</button>
                    </form>
                </div>
                
                <h3 style="margin-top: 30px; margin-bottom: 20px;">${currentLang === 'de' ? 'Vorhandene Artikel' : 'Existing Articles'}</h3>
                <div id="newsList">
                    ${news.map(item => `
                        <div class="item-card ${item.featured ? 'active' : ''}">
                            <div class="item-header">
                                <div>
                                    <div class="item-title">${currentLang === 'de' ? item.titleDe : item.titleEn || item.titleDe}</div>
                                    <small style="color: #94a3b8;">${item.date} ${item.featured ? '‚≠ê Featured' : ''}</small>
                                </div>
                                <div class="item-actions">
                                    <button class="delete-btn" onclick="deleteNews(${item.id})">${currentLang === 'de' ? 'L√∂schen' : 'Delete'}</button>
                                </div>
                            </div>
                            <p style="color: #94a3b8; font-size: 14px;">${(currentLang === 'de' ? item.contentDe : item.contentEn || item.contentDe).substring(0, 150)}...</p>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function addNews(event) {
            event.preventDefault();
            
            const newsItem = {
                id: Date.now(),
                titleDe: document.getElementById('news-title-de').value,
                titleEn: document.getElementById('news-title-en').value,
                contentDe: document.getElementById('news-content-de').value,
                contentEn: document.getElementById('news-content-en').value,
                date: document.getElementById('news-date').value,
                featured: document.getElementById('news-featured').checked
            };
            
            let news = JSON.parse(localStorage.getItem('kdaoNews') || '[]');
            news.unshift(newsItem);
            localStorage.setItem('kdaoNews', JSON.stringify(news));
            
            loadNews();
            updateDashboard();
            showSuccess();
        }

        function deleteNews(id) {
            if(confirm(currentLang === 'de' ? 'Artikel wirklich l√∂schen?' : 'Really delete article?')) {
                let news = JSON.parse(localStorage.getItem('kdaoNews') || '[]');
                news = news.filter(item => item.id !== id);
                localStorage.setItem('kdaoNews', JSON.stringify(news));
                loadNews();
                updateDashboard();
                showSuccess();
            }
        }

        // TEAM MANAGEMENT
        function loadTeam() {
            const container = document.getElementById('teamSection');
            
            if (!hasPermission('team')) {
                container.innerHTML = `<div class="no-permission">${currentLang === 'de' ? 'Keine Berechtigung f√ºr diesen Bereich' : 'No permission for this section'}</div>`;
                return;
            }
            
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            const categories = [...new Set(team.map(t => t.category))];
            
            container.innerHTML = `
                <h2 class="section-title">${currentLang === 'de' ? 'Team Verwaltung' : 'Team Management'}</h2>
                <h3>${currentLang === 'de' ? 'Team Positionen' : 'Team Positions'}</h3>
                ${categories.map(category => `
                    <h4 style="margin: 20px 0 10px; color: #5ffbf1;">${category}</h4>
                    ${team.filter(t => t.category === category).map(member => `
                        <div class="item-card ${member.status === 'active' ? 'active' : ''}">
                            <div class="view-mode ${member.editing ? 'hidden' : ''}" id="team-view-${member.id}">
                                <div class="item-header">
                                    <div>
                                        <div class="item-title">${member.position}</div>
                                        <div style="color: #94a3b8; font-size: 14px; margin-top: 5px;">
                                            ${member.name ? `üë§ ${member.name}` : currentLang === 'de' ? 'Position unbesetzt' : 'Position vacant'}
                                        </div>
                                    </div>
                                    <div class="item-actions">
                                        <button class="${member.status === 'active' ? 'status-toggle active' : 'status-toggle'}" 
                                                onclick="toggleTeamStatus(${member.id})">
                                            ${member.status === 'active' ? (currentLang === 'de' ? 'Aktiv' : 'Active') : (currentLang === 'de' ? 'Vakant' : 'Vacant')}
                                        </button>
                                        <button class="edit-btn" onclick="editTeamMember(${member.id})">${currentLang === 'de' ? 'Bearbeiten' : 'Edit'}</button>
                                        <button class="delete-btn" onclick="deleteTeamMember(${member.id})">${currentLang === 'de' ? 'L√∂schen' : 'Delete'}</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="edit-mode ${member.editing ? 'active' : ''}" id="team-edit-${member.id}">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Position</label>
                                        <input type="text" id="position-${member.id}" value="${member.position}">
                                    </div>
                                    <div class="form-group">
                                        <label>${currentLang === 'de' ? 'Name' : 'Name'}</label>
                                        <input type="text" id="name-${member.id}" value="${member.name || ''}" 
                                               placeholder="${currentLang === 'de' ? 'Leer lassen wenn unbesetzt' : 'Leave empty if vacant'}">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>${currentLang === 'de' ? 'Beschreibung' : 'Description'}</label>
                                    <textarea id="desc-${member.id}" rows="2">${member.description || ''}</textarea>
                                </div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="save-btn" onclick="saveTeamMember(${member.id})">${currentLang === 'de' ? 'Speichern' : 'Save'}</button>
                                    <button class="delete-btn" onclick="cancelEdit(${member.id})">${currentLang === 'de' ? 'Abbrechen' : 'Cancel'}</button>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                `).join('')}
                <button class="add-btn" onclick="addTeamPosition()">${currentLang === 'de' ? '+ Neue Position hinzuf√ºgen' : '+ Add New Position'}</button>
            `;
        }

        function editTeamMember(id) {
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            team = team.map(m => ({ ...m, editing: m.id === id }));
            localStorage.setItem('kdaoTeam', JSON.stringify(team));
            loadTeam();
        }

        function cancelEdit(id) {
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            team = team.map(m => ({ ...m, editing: false }));
            localStorage.setItem('kdaoTeam', JSON.stringify(team));
            loadTeam();
        }

        function saveTeamMember(id) {
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            const position = document.getElementById(`position-${id}`).value;
            const name = document.getElementById(`name-${id}`).value;
            const description = document.getElementById(`desc-${id}`).value;
            
            team = team.map(m => {
                if(m.id === id) {
                    return {
                        ...m,
                        position,
                        name,
                        description,
                        status: name ? 'active' : 'vacant',
                        editing: false
                    };
                }
                return m;
            });
            
            localStorage.setItem('kdaoTeam', JSON.stringify(team));
            loadTeam();
            updateDashboard();
            showSuccess();
        }

        function toggleTeamStatus(id) {
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            team = team.map(m => {
                if(m.id === id) {
                    return { ...m, status: m.status === 'active' ? 'vacant' : 'active' };
                }
                return m;
            });
            localStorage.setItem('kdaoTeam', JSON.stringify(team));
            loadTeam();
            updateDashboard();
            showSuccess();
        }

        function deleteTeamMember(id) {
            if(confirm(currentLang === 'de' ? 'Position wirklich l√∂schen?' : 'Really delete position?')) {
                let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
                team = team.filter(m => m.id !== id);
                localStorage.setItem('kdaoTeam', JSON.stringify(team));
                loadTeam();
                updateDashboard();
                showSuccess();
            }
        }

        function addTeamPosition() {
            const position = prompt(currentLang === 'de' ? 'Position eingeben:' : 'Enter position:');
            if(!position) return;
            
            const category = prompt(currentLang === 'de' ? 'Kategorie (z.B. Technisches Team, Operations, Community):' : 'Category (e.g. Technical Team, Operations, Community):');
            if(!category) return;
            
            let team = JSON.parse(localStorage.getItem('kdaoTeam') || JSON.stringify(defaultTeamPositions));
            team.push({
                id: Date.now(),
                category,
                position,
                name: '',
                status: 'vacant',
                description: ''
            });
            
            localStorage.setItem('kdaoTeam', JSON.stringify(team));
            loadTeam();
            updateDashboard();
            showSuccess();
        }

        // ROADMAP MANAGEMENT
        function loadRoadmap() {
            const container = document.getElementById('roadmapSection');
            
            if (!hasPermission('roadmap')) {
                container.innerHTML = `<div class="no-permission">${currentLang === 'de' ? 'Keine Berechtigung f√ºr diesen Bereich' : 'No permission for this section'}</div>`;
                return;
            }
            
            let roadmap = JSON.parse(localStorage.getItem('kdaoRoadmap') || JSON.stringify(defaultRoadmapPhases));
            
            container.innerHTML = `
                <h2 class="section-title">${currentLang === 'de' ? 'Roadmap Verwaltung' : 'Roadmap Management'}</h2>
                ${roadmap.map(phase => `
                    <div class="item-card ${phase.completed ? 'phase-complete' : ''}">
                        <div class="item-header">
                            <div>
                                <div class="item-title">${phase.title}</div>
                                <small style="color: #94a3b8;">${phase.date}</small>
                                <p style="color: #94a3b8; font-size: 14px; margin-top: 10px;">${phase.description}</p>
                            </div>
                            <div class="item-actions">
                                <button class="${phase.completed ? 'status-toggle active' : 'status-toggle'}" 
                                        onclick="togglePhaseComplete(${phase.id})">
                                    ${phase.completed ? (currentLang === 'de' ? '‚úì Erledigt' : '‚úì Complete') : (currentLang === 'de' ? 'In Arbeit' : 'In Progress')}
                                </button>
                                <button class="delete-btn" onclick="deletePhase(${phase.id})">${currentLang === 'de' ? 'L√∂schen' : 'Delete'}</button>
                            </div>
                        </div>
                    </div>
                `).join('')}
                <button class="add-btn" onclick="addRoadmapPhase()">${currentLang === 'de' ? '+ Neue Phase hinzuf√ºgen' : '+ Add New Phase'}</button>
            `;
        }

        function togglePhaseComplete(id) {
            let roadmap = JSON.parse(localStorage.getItem('kdaoRoadmap') || JSON.stringify(defaultRoadmapPhases));
            roadmap = roadmap.map(phase => {
                if(phase.id === id) {
                    return { ...phase, completed: !phase.completed };
                }
                return phase;
            });
            localStorage.setItem('kdaoRoadmap', JSON.stringify(roadmap));
            loadRoadmap();
            updateDashboard();
            showSuccess();
        }

        function deletePhase(id) {
            if(confirm(currentLang === 'de' ? 'Phase wirklich l√∂schen?' : 'Really delete phase?')) {
                let roadmap = JSON.parse(localStorage.getItem('kdaoRoadmap') || JSON.stringify(defaultRoadmapPhases));
                roadmap = roadmap.filter(phase => phase.id !== id);
                localStorage.setItem('kdaoRoadmap', JSON.stringify(roadmap));
                loadRoadmap();
                updateDashboard();
                showSuccess();
            }
        }

        function addRoadmapPhase() {
            const title = prompt(currentLang === 'de' ? 'Phase Titel:' : 'Phase Title:');
            if(!title) return;
            
            const date = prompt(currentLang === 'de' ? 'Zeitraum (z.B. Q1 2026):' : 'Time period (e.g. Q1 2026):');
            if(!date) return;
            
            const description = prompt(currentLang === 'de' ? 'Beschreibung:' : 'Description:');
            
            let roadmap = JSON.parse(localStorage.getItem('kdaoRoadmap') || JSON.stringify(defaultRoadmapPhases));
            roadmap.push({
                id: Date.now(),
                title,
                date,
                description: description || '',
                completed: false
            });
            
            localStorage.setItem('kdaoRoadmap', JSON.stringify(roadmap));
            loadRoadmap();
            updateDashboard();
            showSuccess();
        }

        // USER MANAGEMENT (Admin only)
        function loadUsers() {
            if (!currentUser || currentUser.role !== 'admin') return;
            
            const users = JSON.parse(localStorage.getItem('kdaoUsers') || JSON.stringify(defaultUsers));
            const container = document.getElementById('usersList');
            
            container.innerHTML = users.map(user => `
                <tr>
                    <td>${user.username}</td>
                    <td><span class="user-role ${user.role}">${ROLES[user.role].name}</span></td>
                    <td>${user.role === 'admin' ? 'All' : ROLES[user.role].permissions.join(', ')}</td>
                    <td>
                        ${user.username !== 'admin' ? 
                            `<button class="delete-btn" onclick="deleteUser('${user.username}')">${currentLang === 'de' ? 'L√∂schen' : 'Delete'}</button>` : 
                            '<span style="color: #6b7280;">Protected</span>'}
                    </td>
                </tr>
            `).join('');
        }

        function addUser(event) {
            event.preventDefault();
            
            const newUser = {
                username: document.getElementById('new-username').value,
                password: document.getElementById('new-password').value,
                role: document.getElementById('new-role').value
            };
            
            let users = JSON.parse(localStorage.getItem('kdaoUsers') || JSON.stringify(defaultUsers));
            
            if (users.find(u => u.username === newUser.username)) {
                alert(currentLang === 'de' ? 'Benutzername existiert bereits!' : 'Username already exists!');
                return;
            }
            
            users.push(newUser);
            localStorage.setItem('kdaoUsers', JSON.stringify(users));
            
            event.target.reset();
            loadUsers();
            showSuccess();
        }

        function deleteUser(username) {
            if(confirm(currentLang === 'de' ? `Benutzer "${username}" wirklich l√∂schen?` : `Really delete user "${username}"?`)) {
                let users = JSON.parse(localStorage.getItem('kdaoUsers') || JSON.stringify(defaultUsers));
                users = users.filter(u => u.username !== username);
                localStorage.setItem('kdaoUsers', JSON.stringify(users));
                loadUsers();
                showSuccess();
            }
        }

        // Settings
        function saveSettings(event) {
            event.preventDefault();
            
            const settings = {
                discord: document.getElementById('discord-link').value,
                twitter: document.getElementById('twitter-link').value,
                coinex: document.getElementById('coinex-link').value
            };
            
            localStorage.setItem('kdaoSettings', JSON.stringify(settings));
            showSuccess();
        }

        // Show success message
        function showSuccess() {
            const msg = document.getElementById('successMessage');
            msg.style.display = 'block';
            setTimeout(() => {
                msg.style.display = 'none';
            }, 3000);
        }

        // Initialize with default data if empty
        function initializeDefaults() {
            if(!localStorage.getItem('kdaoUsers')) {
                localStorage.setItem('kdaoUsers', JSON.stringify(defaultUsers));
            }
            if(!localStorage.getItem('kdaoTeam')) {
                localStorage.setItem('kdaoTeam', JSON.stringify(defaultTeamPositions));
            }
            if(!localStorage.getItem('kdaoRoadmap')) {
                localStorage.setItem('kdaoRoadmap', JSON.stringify(defaultRoadmapPhases));
            }
        }

        // Initialize
        initializeDefaults();
        const savedLang = localStorage.getItem('adminLang') || 'de';
        setAdminLanguage(savedLang);
        checkAuth();
    </script>
</body>
</html>